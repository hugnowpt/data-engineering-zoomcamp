id: 00-file-size
namespace: zoomcamp

inputs:
  - id: taxi
    type: SELECT
    displayName: Taxi Type
    values:
      - yellow
      - green
    defaults: yellow

  - id: year
    type: STRING
    displayName: Year
    defaults: "2020"

  - id: month
    type: STRING
    displayName: Month
    defaults: "12"

tasks:
  - id: get_file_size
    type: io.kestra.plugin.scripts.shell.Commands
    taskRunner:
      type: io.kestra.plugin.scripts.runner.docker.Docker
    containerImage: python:3.10
    commands:
      - >
        wget -qO-
        https://github.com/DataTalksClub/nyc-tlc-data/releases/download/{{inputs.taxi}}/{{inputs.taxi}}_tripdata_{{inputs.year}}-{{inputs.month}}.csv.gz
        | gunzip > output.csv
      - ls -lh output.csv
